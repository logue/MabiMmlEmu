/** @license sf2synth.js 2013 - imaya / GREE Inc. [ https://github.com/gree/sf2synth.js ], 2013-2018 - Logue [ https://github.com/logue/sf2synth.js ] The MIT License */(function() {'use strict';var q,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(a,b){if(b){var c=ba;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}
ca("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var e=d.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var g=d[c];if(g===b||Object.is(g,b))return!0}return!1}});var u=this;
function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function v(a,b){a=a.split(".");var c=u;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]?c=c[d]:c=c[d]={}:c[d]=b};function x(a,b,c){this.a=a;this.o=b;this.m=c;this.key=c.key;this.A=c.velocity;this.l=c.sample;this.h=c.basePlaybackRate;this.sampleRate=c.sampleRate;this.volume=c.volume;this.w=c.panpot;this.s=c.pitchBend;this.v=c.pitchBendSensitivity;this.G=c.modEnvToPitch;this.g=c.expression;this.D=a.currentTime;this.c=this.h|0;this.j=!1}function B(a){return 440*Math.pow(2,(a-6900)/1200)}
function D(a){var b=a.m,c=a.i,d=a.f,e=a.a.currentTime,g=b.releaseTime-64;g=e+b.volRelease*d.gain.value*(1+g/(0>g?64:63));var f=a.N,h=B(b.initialFilterFc),l=B(b.initialFilterFc+b.modEnvToFilterFc);l=e+b.modRelease*(h===l?1:(f.frequency.value-h)/(l-h));if(a.F)switch(b.sampleModes){case 1:d.gain.cancelScheduledValues(0);d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(0,g);f.frequency.cancelScheduledValues(0);f.frequency.setValueAtTime(f.frequency.value,e);f.frequency.linearRampToValueAtTime(h,
l);c.playbackRate.cancelScheduledValues(0);c.playbackRate.setValueAtTime(c.playbackRate.value,e);c.playbackRate.linearRampToValueAtTime(a.c,l);c.stop(g);break;case 2:u.console.log("detect unused sampleModes");break;case 3:c.loop=!1}}x.prototype.connect=function(){this.f.connect(this.o)};x.prototype.disconnect=function(){this.f.disconnect(0)};
function ea(a,b){a.c=a.h*Math.pow(Math.pow(2,1/12),b/(0>b?8192:8191)*a.v*a.m.scaleTuning);b=a.i.playbackRate;var c=a.c,d=a.D,e=a.m,g=d+e.modAttack,f=g+e.modDecay;a=c*Math.pow(Math.pow(2,1/12),a.G*a.m.scaleTuning);b.cancelScheduledValues(0);b.setValueAtTime(c,d);b.linearRampToValueAtTime(a,g);b.linearRampToValueAtTime(c+(a-c)*(1-e.modSustain),f)};function F(a,b){b=b||{};this.input=a;this.b=b.index||0;this.length=b.length||a.length-this.b;this.offset=this.b;this.c=void 0!==b.padding?b.padding:!0;this.f=void 0!==b.bigEndian?b.bigEndian:!1}function fa(a,b,c){this.type=a;this.a=b;this.offset=c}
F.prototype.parse=function(){var a=this.length+this.offset;for(this.a=[];this.b<a;){var b=this.input;var c=this.b;this.a.push(new fa(String.fromCharCode(b[c++],b[c++],b[c++],b[c++]),b=this.f?(b[c++]<<24|b[c++]<<16|b[c++]<<8|b[c++])>>>0:(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,c));c+=b;this.c&&1===(c-this.offset&1)&&c++;this.b=c}};function G(a,b){a=a.a[b];return void 0===a?null:a};function H(a,b){b=b||{};this.input=a;this.Ca=b.parserOption;this.sampleRate=b.sampleRate||22050}
H.prototype.parse=function(){var a,b=new F(this.input,this.Ca);b.parse();if(1!==b.a.length)throw Error("wrong chunk length");b=G(b,0);if(null===b)throw Error("chunk not found");var c=this.input,d=b.offset;if("RIFF"!==b.type)throw Error("invalid chunk type:"+b.type);var e=String.fromCharCode(c[d++],c[d++],c[d++],c[d++]);if("sfbk"!==e)throw Error("invalid signature:"+e);b=new F(c,{index:d,length:b.a-4});b.parse();if(3!==b.a.length)throw Error("invalid sfbk structure");c=G(b,0);d=this.input;e=c.offset;
if("LIST"!==c.type)throw Error("invalid chunk type:"+c.type);var g=String.fromCharCode(d[e++],d[e++],d[e++],d[e++]);if("INFO"!==g)throw Error("invalid signature:"+g);(new F(d,{index:e,length:c.a-4})).parse();c=G(b,1);d=this.input;e=c.offset;if("LIST"!==c.type)throw Error("invalid chunk type:"+c.type);g=String.fromCharCode(d[e++],d[e++],d[e++],d[e++]);if("sdta"!==g)throw Error("invalid signature:"+g);c=new F(d,{index:e,length:c.a-4});c.parse();if(1!==c.a.length)throw Error("TODO");this.ma=G(c,0);b=
G(b,2);c=this.input;d=b.offset;if("LIST"!==b.type)throw Error("invalid chunk type:"+b.type);e=String.fromCharCode(c[d++],c[d++],c[d++],c[d++]);if("pdta"!==e)throw Error("invalid signature:"+e);b=new F(c,{index:d,length:b.a-4});b.parse();if(9!==b.a.length)throw Error("invalid pdta chunk");c=G(b,0);d=this.input;e=c.offset;g=this.Fa=[];var f=c.offset+c.a;if("phdr"!==c.type)throw Error("invalid chunk type:"+c.type);for(;e<f;)g.push({Ga:String.fromCharCode.apply(null,d.subarray(e,e+=20)),Ea:d[e++]|d[e++]<<
8,Z:d[e++]|d[e++]<<8,ia:d[e++]|d[e++]<<8,Pa:(d[e++]|d[e++]<<8|d[e++]<<16|d[e++]<<24)>>>0,Oa:(d[e++]|d[e++]<<8|d[e++]<<16|d[e++]<<24)>>>0,Qa:(d[e++]|d[e++]<<8|d[e++]<<16|d[e++]<<24)>>>0});c=G(b,1);d=this.input;e=c.offset;g=this.Ha=[];f=c.offset+c.a;if("pbag"!==c.type)throw Error("invalid chunk type:"+c.type);for(;e<f;)g.push({ja:d[e++]|d[e++]<<8,O:d[e++]|d[e++]<<8});c=G(b,2);if("pmod"!==c.type)throw Error("invalid chunk type:"+c.type);this.la=ha(this,c);c=G(b,3);if("pgen"!==c.type)throw Error("invalid chunk type:"+
c.type);this.ka=ia(this,c);c=G(b,4);d=this.input;e=c.offset;g=this.m=[];f=c.offset+c.a;if("inst"!==c.type)throw Error("invalid chunk type:"+c.type);for(;e<f;)g.push({ya:String.fromCharCode.apply(null,d.subarray(e,e+=20)),ca:d[e++]|d[e++]<<8});c=G(b,5);d=this.input;e=c.offset;g=this.za=[];f=c.offset+c.a;if("ibag"!==c.type)throw Error("invalid chunk type:"+c.type);for(;e<f;)g.push({da:d[e++]|d[e++]<<8,xa:d[e++]|d[e++]<<8});c=G(b,6);if("imod"!==c.type)throw Error("invalid chunk type:"+c.type);this.fa=
ha(this,c);c=G(b,7);if("igen"!==c.type)throw Error("invalid chunk type:"+c.type);this.ea=ia(this,c);f=G(b,8);b=this.input;c=f.offset;d=this.Ia=[];e=this.Ja=[];g=f.offset+f.a;if("shdr"!==f.type)throw Error("invalid chunk type:"+f.type);for(;c<g;){f=String.fromCharCode.apply(null,b.subarray(c,c+=20));var h=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var l=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var r=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var n=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<
24)>>>0;var m=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var t=b[c++];var p=b[c++]<<24>>24;var w=b[c++]|b[c++]<<8;var y=b[c++]|b[c++]<<8;var z=new Int16Array((new Uint8Array(b.subarray(this.ma.offset+2*h,this.ma.offset+2*l))).buffer);r-=h;n-=h;if(0<m){var E,k=z,A=m;for(a=1;A<this.sampleRate;){var J=new Int16Array(2*k.length);var I=z=0;for(E=k.length;I<E;++I)J[z++]=k[I],J[z++]=k[I];k=J;a*=2;A*=2}z=k;m*=a;r*=a;n*=a}d.push(z);e.push({Sa:f,start:h,end:l,Ma:r,va:n,sampleRate:m,Ba:t,Da:p,Ra:w,Ta:y})}this.input=
null};function ha(a,b){a=a.input;var c=b.offset;b=b.offset+b.a;for(var d,e,g=[];c<b;){c+=2;d=a[c++]|a[c++]<<8;e=ja[d];if(void 0===e)g.push({type:e,value:{code:d,u:a[c]|a[c+1]<<8<<16>>16,C:a[c++],B:a[c++]}});else switch(e){case "keyRange":case "velRange":case "keynum":case "velocity":g.push({type:e,value:{C:a[c++],B:a[c++]}});break;default:g.push({type:e,value:{u:a[c++]|a[c++]<<8<<16>>16}})}c+=2;c+=2}return g}
function ia(a,b){a=a.input;var c=b.offset;b=b.offset+b.a;for(var d,e,g=[];c<b;)if(d=a[c++]|a[c++]<<8,e=ja[d],void 0===e)g.push({type:e,value:{code:d,u:a[c]|a[c+1]<<8<<16>>16,C:a[c++],B:a[c++]}});else switch(e){case "keynum":case "keyRange":case "velRange":case "velocity":g.push({type:e,value:{C:a[c++],B:a[c++]}});break;default:g.push({type:e,value:{u:a[c++]|a[c++]<<8<<16>>16}})}return g}
function K(a,b,c){var d=[],e={Na:[],keyRange:{B:127,C:0}},g;for(g=a;g<b;++g)a=c[g],d.push(a),"unknown"===a.type?e.Na.push(a.value):e[a.type]=a.value;return{I:e,J:d}}
var ja=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",,"chorusEffectsSend","reverbEffectsSend","pan",,,,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay",
"delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",,"scaleTuning","exclusiveClass","overridingRootKey","endOper"];function ka(a){var b={time:3,ha:0,ua:8,delay:1};this.a=a;this.i=this.a.createGain();this.h=this.a.createGain();this.node=this.a.createConvolver();this.b=this.a.createBiquadFilter();this.c=350;this.f=2;this.j=0;this.l="lowpass";this.o=1;this.g=!1;this.s=3;for(var c in b)void 0!==b[c]&&(this["_"+c]=b[c]);this.ha(this.o);this.b.type=this.l=this.l;this.c=this.c;this.b.frequency.setTargetAtTime(this.c,this.a.currentTime,.015);M(this);this.node.connect(this.h);this.node.connect(this.i);this.node.connect(this.b);
this.h.connect(this.node);this.i.connect(this.node);this.b.connect(this.node)}
function M(a){var b=a.a.sampleRate,c=Math.max(b*a.s,1),d=b*a.j;b=a.a.createBuffer(2,c,b);for(var e=new Float32Array(c),g=new Float32Array(c),f=0;f<c;f++){if(f<d)e[f]=0,g[f]=0;else{var h=a.g?c-f:f;h=Math.pow(1-h/c,a.f);e[f]=(2*Math.random()-1)*h;g[f]=(2*Math.random()-1)*h}h=a.g?c-(f-d):f-d;h=Math.pow(1-h/c,a.f);e[f]=(2*Math.random()-1)*h;g[f]=(2*Math.random()-1)*h}b.getChannelData(0).set(e);b.getChannelData(1).set(g);u.console.info("Update impulse responce.");a.node.buffer=b}q=ka.prototype;
q.ha=function(a){this.o=a;this.h.gain.setTargetAtTime((1<a||0>a?0:.5>=a?1:1-2*(a-.5))/127,this.a.currentTime,.015);this.i.gain.setTargetAtTime((1<a||0>a?0:.5<=a?1:1-2*(a-.5))/127,this.a.currentTime,.015)};q.time=function(a){this.s=a;M(this)};q.ua=function(a){this.f=a;M(this)};q.delay=function(a){this.j=a;M(this)};q.reverse=function(a){this.g=a;M(this)};function la(a){var b;this.input=a;this.K={};this.Z=0;this.f={};if(void 0!==u.AudioContext)a=new u.AudioContext;else if(void 0!==u.webkitAudioContext)a=new u.webkitAudioContext;else if(void 0!==u.mozAudioContext)a=new u.mozAudioContext;else throw Error("Web Audio not supported");void 0===a.createGainNode&&(a.createGainNode=a.createGain);this.b=a;this.h=this.b.createGain();this.D=this.b.createBufferSource();this.c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.a=[0,0,0,0,0,0,0,0,0,0,0,127,0,0,0,0];this.W=[127,
127,127,127,127,127,127,127,127,127,127,127,127,127,127,127];this.U=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.G=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2];this.F=[127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127];this.R=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.S=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.qa=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.w=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];
this.s=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.pa=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.oa=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.j=this.A=!1;this.T=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.g=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];this.na=1/65535;this.i=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1];this.o=Array(128);a=0;for(b=this.o.length;a<b;++a)this.o[a]=127;this.v={};this.Y=!0;this.l=new ka(this.b)}
function N(a,b="GM"){a.K=new H(a.input,{sampleRate:a.b.sampleRate});a.f=qa(a);a.j=!1;a.A=!1;"XG"==b?a.j=!0:"GS"==b&&(a.A=!0);for(b=0;16>b;++b)O(a,b,0),ra(a,b,100),sa(a,b,64),P(a,b,0,64),Q(a,b,2),a.s[b]=!1,a.F[b]=127,a.a[b]=9===b?127:0,a.R[b]=64,a.S[b]=64,a.qa[b]=64,a.w[b]=64,a.L(b,64),a.H(b,64),a.P(b,40),R(a,b),ta(a,b);S(a,9,!0);for(b=0;128>b;++b)a.o[b]=127;a.Y&&(a.l.node.disconnect(0),a.h.connect(a.l.node),a.l.node.connect(a.b.destination))}q=la.prototype;q.close=function(){this.b.close()};
function qa(a){var b=a.K;b.parse();var c=b.Fa,d=b.Ha,e=[],g,f;var h=0;for(f=c.length;h<f;++h){var l=c[h].ia;var r=c[h+1]?c[h+1].ia:d.length;for(g=[];l<r;++l){var n=K(d[l].ja,d[l+1]?d[l+1].ja:b.ka.length,b.ka);var m=n.I;var t=n.J;var p=K(d[l].O,d[l+1]?d[l+1].O:b.la.length,b.la);n=p.I;p=p.J;g.push({aa:m,wa:t,N:n,Aa:p});m=void 0!==m.instrument?m.instrument.u:void 0!==n.instrument?n.instrument.u:null}e.push({name:c[h].Ga,info:g,ba:c[h],m})}d=b.m;g=b.za;c=[];f=0;for(l=d.length;f<l;++f){r=d[f].ca;m=d[f+
1]?d[f+1].ca:g.length;h=[];for(n=m;r<n;++r){t=K(g[r].da,g[r+1]?g[r+1].da:b.ea.length,b.ea);m=t.I;p=t.J;var w=K(g[r].O,g[r+1]?g[r+1].xa:b.fa.length,b.fa);t=w.I;w=w.J;h.push({aa:m,wa:p,N:t,Aa:w})}c.push({name:d[f].ya,info:h})}d=[];m=[];f=0;for(l=e.length;f<l;++f)if(n=e[f],h=n.ba.Ea,g=n.ba.Z,r=n.name.replace(/\0*$/,""),"number"==typeof n.m&&(t=c[n.m],"EOI"!==t.name.replace(/\0*$/,""))){void 0===d[g]&&(d[g]=[]);n=d[g];n[h]={};n[h].name=r;p=0;for(w=t.info.length;p<w;++p){var y,z=b,E=n[h],k=t.info[p].aa;
if(void 0!==k.keyRange&&void 0!==k.sampleID){var A=T(k,"delayVolEnv",-12E3);var J=T(k,"attackVolEnv",-12E3);var I=T(k,"holdVolEnv",-12E3);var xa=T(k,"decayVolEnv",-12E3);var ya=T(k,"sustainVolEnv");var za=T(k,"releaseVolEnv",-12E3);var Aa=T(k,"delayModEnv",-12E3);var Ba=T(k,"attackModEnv",-12E3);var Ca=T(k,"holdModEnv",-12E3);var Da=T(k,"decayModEnv",-12E3);var Ea=T(k,"sustainModEnv");var Fa=T(k,"releaseModEnv",-12E3);var Ga=T(k,"coarseTune")+T(k,"fineTune")/100;var ma=T(k,"scaleTuning",100)/100;
var na=T(k,"freqVibLFO");var oa=T(k,"pan");var C=k.keyRange.C;for(y=k.keyRange.B;C<=y;++C)if(!E[C]){var pa=T(k,"sampleID");var L=z.Ja[pa];E[C]={sample:z.Ia[pa],sampleRate:L.sampleRate,sampleModes:T(k,"sampleModes"),basePlaybackRate:Math.pow(Math.pow(2,1/12),(C-T(k,"overridingRootKey",L.Ba)+Ga+L.Da/100)*ma),modEnvToPitch:T(k,"modEnvToPitch")/100,scaleTuning:ma,start:32768*T(k,"startAddrsCoarseOffset")+T(k,"startAddrsOffset"),end:32768*T(k,"endAddrsCoarseOffset")+T(k,"endAddrsOffset"),loopStart:L.Ma+
32768*T(k,"startloopAddrsCoarseOffset")+T(k,"startloopAddrsOffset"),loopEnd:L.va+32768*T(k,"endloopAddrsCoarseOffset")+T(k,"endloopAddrsOffset"),volDelay:Math.pow(2,A/1200),volAttack:Math.pow(2,J/1200),volHold:Math.pow(2,I/1200)*Math.pow(2,(60-C)*T(k,"keynumToVolEnvHold")/1200),volDecay:Math.pow(2,xa/1200)*Math.pow(2,(60-C)*T(k,"keynumToVolEnvDecay")/1200),volSustain:ya/1E3,volRelease:Math.pow(2,za/1200),modDelay:Math.pow(2,Aa/1200),modAttack:Math.pow(2,Ba/1200),modHold:Math.pow(2,Ca/1200)*Math.pow(2,
(60-C)*T(k,"keynumToModEnvHold")/1200),modDecay:Math.pow(2,Da/1200)*Math.pow(2,(60-C)*T(k,"keynumToModEnvDecay")/1200),modSustain:Ea/1E3,modRelease:Math.pow(2,Fa/1200),initialFilterFc:T(k,"initialFilterFc",13500),modEnvToFilterFc:T(k,"modEnvToFilterFc"),initialFilterQ:T(k,"initialFilterQ"),reverbEffectSend:T(k,"reverbEffectSend"),initialAttenuation:T(k,"initialAttenuation"),freqVibLFO:na?8.176*Math.pow(2,na/1200):void 0,pan:oa?oa/1200:void 0}}}}m[g]||(m[g]={});m[g][h]=r}a.v=m;return d}
function T(a,b,c){void 0===c&&(c=0);return a[b]?a[b].u:c}q.start=function(){this.connect();U(this,16383);this.D.start(0)};function U(a,b){a.h.gain.setTargetAtTime(b/16384*a.na,a.b.currentTime,.015)}q.connect=function(){V(this,!0);this.D.connect(this.h);this.h.connect(this.b.destination)};q.disconnect=function(){V(this,!1);this.D.disconnect(0);this.h.disconnect(0)};function V(a,b){(a.Y=b)?(a.h.connect(a.l.node),a.l.node.connect(a.b.destination)):a.l.node.disconnect(0)}q.P=function(a,b){this.P[a]=b};
function ua(a){const b=u.window.document,c=a.element=b.createElement("div"),d=b.createElement("div");d.className="instrument";const e="mute bank program volume panpot pitchBend pitchBendSensitivity keys".split(" ");let g;for(let l=0;16>l;l++){g=b.createElement("div");g.className="channel";for(let r in e){let n=b.createElement("div");n.className=e[r];switch(e[r]){case "mute":var f=document.createElement("div");f.className="custom-control custom-checkbox custom-control-inline";var h=b.createElement("input");
h.setAttribute("type","checkbox");h.className="custom-control-input";h.id="mute"+l+"ch";h.addEventListener("change",function(m,t){return function(){var p=this.checked,w=m.g[t],y;if(m.T[t]=p)for(p=0,y=w.length;p<y;++p)w[p].disconnect();else for(p=0,y=w.length;p<y;++p)w[p].connect()}}(a,l),!1);f.appendChild(h);h=b.createElement("label");h.className="custom-control-label";h.textContent=l+1;h.setAttribute("for","mute"+l+"ch");f.appendChild(h);n.appendChild(f);break;case "bank":f=b.createElement("select");
f.className="form-control form-control-sm";n.appendChild(f);f.appendChild(b.createElement("option"));f.addEventListener("change",function(m,t){return function(p){va(m,t,p.target.value);O(m,t,m.c[t])}}(a,l),!1);f.selectedIndex=a.c[r];break;case "program":f=b.createElement("select");f.className="form-control form-control-sm";n.appendChild(f);f.addEventListener("change",function(m,t){return function(p){O(m,t,p.target.value)}}(a,l),!1);f.selectedIndex=a.c[r];break;case "volume":n.innerText=100;case "pitchBendSensitivity":n.innerText=
2;break;case "panpot":f=b.createElement("meter");f.min=0;f.max=127;f.value=64;n.appendChild(f);break;case "pitchBend":f=b.createElement("meter");f.min=-8192;f.max=8192;f.value=0;n.appendChild(f);break;case "keys":for(f=0;127>f;f++)h=b.createElement("div"),h.className="key "+([1,3,6,8,10].includes(f%12)?"semitone":"tone"),n.appendChild(h),h.addEventListener("mousedown",function(m,t,p){return function(w){w.preventDefault();m.X=!0;W(m,t,p,127)}}(a,l,f)),h.addEventListener("mouseover",function(m,t,p){return function(w){w.preventDefault();
m.X&&W(m,t,p,127)}}(a,l,f)),h.addEventListener("mouseout",function(m,t,p){return function(w){w.preventDefault();X(m,t,p)}}(a,l,f)),h.addEventListener("mouseup",function(m,t,p){return function(w){w.preventDefault();m.X=!1;X(m,t,p)}}(a,l,f))}g.appendChild(n)}d.appendChild(g)}c.appendChild(d);return c}
function W(a,b,c,d){var e=a.a[b],g="object"===typeof a.f[e]?a.f[e]:a.f[0];g="object"===typeof g[a.c[b]]?g[a.c[b]]:a.f[0][a.c[b]];void 0===g&&(g=125>e?a.f[0][a.c[b]]:a.f[e][0]);if(void 0===g[c])u.console.warn("instrument not found: bank=%s instrument=%s channel=%s key=%s",e,a.c[b],b,c);else{var f=g[c];var h=a.U[b]-64;f.channel=b;f.key=c;f.velocity=d;f.panpot=h/(0>h?64:63);f.volume=a.W[b]/127;f.pitchBend=a.V[b]-8192;f.expression=a.F[b];f.pitchBendSensitivity=Math.round(a.G[b]);f.mute=a.T[b];f.releaseTime=
a.w[b];f.cutOffFrequency=a.H[b];f.harmonicContent=a.L[b];125<e&&(42!==c&&44!==c||X(a,b,46),80===c&&X(a,b,81),g.volume*=a.o[c]/127);e=new x(a.b,a.h,f);var l=e.a;g=e.m;var r=e.l;f=e.a.currentTime;var n=f+g.volDelay;h=f+g.modDelay;var m=n+g.volAttack+g.volHold,t=n+g.modAttack+g.modHold,p=m+g.volDecay,w=t+g.modDecay;var y=g.loopStart/e.sampleRate;var z=g.loopEnd/e.sampleRate;var E=g.start/e.sampleRate;var k=void 0!==g.pan?g.pan:e.w;r=r.subarray(0,r.length+g.end);var A=e.F=l.createBuffer(1,r.length,e.sampleRate);
A.getChannelData(0).set(r);r=e.i=l.createBufferSource();r.buffer=A;r.loop=g.sampleModes;r.loopStart=y;r.loopEnd=z;ea(e,e.s);y=e.f=l.createGain();z=y.gain;e.b=l.createGain();e.b.gain.setTargetAtTime(e.g/127,e.a.currentTime,.015);A=l.createPanner();A.panningModel="equalpower";A.setPosition(Math.sin(k*Math.PI/2),0,Math.cos(k*Math.PI/2));k=e.A/127*e.volume*(1-g.initialAttenuation/1E3);0>k&&(k=0);z.setValueAtTime(0,f).setValueAtTime(0,n).setTargetAtTime(k,n,g.volAttack).setValueAtTime(k,m).linearRampToValueAtTime(k*
(1-g.volSustain),p);n=B(g.initialFilterFc);m=B(g.initialFilterFc+g.modEnvToFilterFc);p=n+(m-n)*(1-g.modSustain);l=e.N=l.createBiquadFilter();l.Q.setValueAtTime(Math.pow(10,g.initialFilterQ/200),f);l.frequency.setTargetAtTime(n/127,e.a.currentTime,.5);l.type="lowpass";l.frequency.setValueAtTime(n,f).setValueAtTime(n,h).setTargetAtTime(m,h,parseFloat(g.modAttack+1)).setValueAtTime(m,t).linearRampToValueAtTime(p,w);r.connect(l);l.connect(A);A.connect(e.b);e.b.connect(y);g.mute||e.connect();r.start(0,
E);a.g[b].push(e);wa(a,b,c,d)}}function X(a,b,c){var d,e=a.g[b],g=a.s[b];var f=0;for(d=e.length;f<d;++f){var h=e[f];h.key===c&&(h.j=!0,g||(D(h),e.splice(f,1),--f,--d))}wa(a,b,c,0)}function wa(a,b,c,d){if(a.element){var e=a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+")");c=e.querySelector(".key:nth-child("+(c+1)+")");0===d?c.classList.remove("note-on"):c.classList.add("note-on");a.s[b]?e.classList.add("hold"):e.classList.remove("hold")}}
function Y(a,b,c){var d=a.g[b];if(!(a.s[b]=!(64>c)))for(b=0,c=d.length;b<c;++b)a=d[b],a.j&&(D(a),d.splice(b,1),--b,--c)}function R(a,b){for(b=a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+") .bank > select");b.firstChild;)b.removeChild(b.firstChild);for(let c in a.v)a=document.createElement("option"),a.value=c,a.textContent=("000"+parseInt(c)).slice(-3),b.appendChild(a)}
function ta(a,b){var c=a.a[b];const d=a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+") .program > select");for(a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+") .bank > select").value=a.a[b];d.firstChild;)d.removeChild(d.firstChild);for(let e in a.v[c]){let g=document.createElement("option");g.value=e;g.textContent=("000"+(parseInt(e)+1)).slice(-3)+":"+a.v[c][e];e===a.c[b]&&(g.selected="selected");d.appendChild(g)}}
function O(a,b,c){a.c[b]=c;va(a,b,a.a[b]);a.element&&(a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+") .program > select").value=c)}function va(a,b,c){a.a[b]="object"===typeof a.f[c]?c:a.i[b]?a.j?127:128:0;ta(a,b);a.element&&(a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+") > .bank > select").value=c)}function ra(a,b,c){a.element&&(a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+") > .volume").innerText=c);a.W[b]=c}
function Ha(a,b,c){var d,e=a.g[b];var g=0;for(d=e.length;g<d;++g){var f=e[g];f.b.gain.setTargetAtTime((f.g=c)/127,f.a.currentTime,.015)}a.F[b]=c}function sa(a,b,c){a.element&&(a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+") > .panpot > meter").value=c);a.U[b]=c}
function P(a,b,c,d){c=c&127|(d&127)<<7;var e,g=a.g[b],f=c-8192;a.element&&(a.element.querySelector(".instrument > .channel:nth-child("+(b+1)+") > .pitchBend > meter").value=f);d=0;for(e=g.length;d<e;++d)ea(g[d],f);a.V[b]=c}function Q(a,b,c){a.element&&(document.querySelector(".instrument > .channel:nth-child("+(b+1)+") > .pitchBendSensitivity").innerText=c);a.G[b]=c}q.L=function(a,b){this.pa[a]=b};q.H=function(a,b){this.oa[a]=b};function S(a,b,c){a.a[b]=a.j?127:128;a.i[b]=c};function Z(a){this.h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.i=!1;this.M=function(){};this.j=this.ra.bind(this);this.a=!0;this.$=void 0!==a.$;this.cache=void 0!==a.cache;this.placeholder=void 0!==a.placeholder?u.document.getElementById(a.placeholder):u.window.document.body;u.window.addEventListener("DOMContentLoaded",function(){this.i=!0}.bind(this),!1)}q=Z.prototype;
q.La=function(a){var b=u.window;this.i?this.load(a):b.addEventListener("DOMContentLoaded",function d(){b.removeEventListener("DOMContentLoaded",d,!1);this.load(a)}.bind(this),!1)};
q.load=function(a){var b=u.window.opener?u.window.opener:u.window.parent,c=this,d=this.placeholder.appendChild(document.createElement("progress")),e=d.parentNode.insertBefore(document.createElement("outpout"),d.nextElementSibling);b.postMessage("link,progress","*");u.window.caches.open("wml").then(g=>{fetch(a).then(f=>{if(!f.ok)throw Error("Network response was not ok.");g.put(a,f);u.window.console.info("cached")}).catch(f=>{u.window.console.error("There has been a problem with your fetch operation: ",
f.message)});g.match(a).then(f=>{f.arrayBuffer().then(h=>{c.placeholder.removeChild(d);c.placeholder.removeChild(e);c.onload(h);"function"==da(c.M)&&c.M(h);b.postMessage("link,ready","*")}).catch(h=>{u.window.console.error("Cache API error: ",h.message)})})})};q.sa=function(a){V(this.b,a)};q.ta=function(){};q.onload=function(a){a=new Uint8Array(a);this.ga(a)};
q.ga=function(a){var b=u.window;if(this.b){var c=this.b;c.input=a;c.K=new H(a);c.f=qa(c)}else c=this.b=new la(a),this.$||this.placeholder.appendChild(ua(c)),N(c),c.start(),b.addEventListener("message",this.j,!1);b.postMessage("link,ready","*")};
q.ra=function(a){var b="function"==da(a.data.split)?a.data.split(","):[],c=b!==[]?b.shift():"";a=u.window.opener?u.window.opener:u.window.parent;switch(c){case "midi":Ia(this,b.map(function(d){return parseInt(d,16)}));break;case "link":if(void 0!==a)switch(b=b.shift(),b){case "reqpatch":a.postMessage("link,patch","*");break;case "setpatch":case "ready":a.postMessage("link,ready","*");break;case "progress":a.postMessage("link,progress","*");break;default:u.console.error("unknown link message:",b)}}};
q.Ka=function(a){this.M=a};
function Ia(a,b){var c=b[0]&15,d=a.b;switch(b[0]&240){case 128:X(d,c,b[1]);break;case 144:0<b[2]?W(d,c,b[1],b[2]):X(d,c,b[1]);break;case 176:var e=b[2];switch(b[1]){case 0:a:{if(d.j)if(64===e)d.a[c]=125,d.i[c]=!0;else{if(126===e||127===e)d.a[c]=e,d.i[c]=!0}else if(d.A)d.a[c]=e,d.i[c]=128===e;else break a;R(d,c)}break;case 6:if(a.a)switch(a.f[c]){case 0:switch(a.c[c]){case 0:Q(d,c,e)}}else switch(a.h[c]){case 26:d.o[a.g[c]]=e}break;case 38:if(a.a)switch(a.f[c]){case 0:switch(a.c[c]){case 0:Q(d,c,d.G[c]+
e/100)}}break;case 7:ra(d,c,e);break;case 10:sa(d,c,e);break;case 120:for(b=d.g[c];0<b.length;)a=b.shift(),X(d,c,a.key),D(a),a.disconnect();Y(d,c,0);break;case 121:b=d.g[c];for(Y(d,c,0);0<b.length;)X(d,c,b[0].key);Ha(d,c,127);P(d,c,0,64);break;case 32:d.j&&!0!==d.i[c]&&(d.i[c]=125<=e,d.a[c]=e,R(d,c));break;case 71:d.L(c,e);break;case 98:a.a=!1;a.g[c]=e;break;case 99:a.a=!1;a.h[c]=e;break;case 100:a.a=!0;a.c[c]=e;break;case 101:a.a=!0;a.f[c]=e;break;case 64:Y(d,c,e);break;case 11:Ha(d,c,e);break;case 71:d.H[c]=
e;break;case 72:d.S[c]=e;break;case 73:d.w[c]=e;break;case 74:d.R[c]=e;break;case 75:d.H(c,e);break;case 91:d.P(c,e)}break;case 192:O(d,c,b[1]);break;case 224:P(d,c,b[1],b[2]);break;case 240:switch(b[1]){case 126:127===b[2]&&9===b[3]&&1===b[4]&&N(d,"GM");break;case 127:switch(b[3]){case 4:switch(b[4]){case 1:U(d,b[5]+(b[6]<<7))}}}switch(b[2]){case 67:8===b[5]&&(0!==b[7]?S(d,b[6],!0):S(d,b[6],!1),u.console.log(b));switch(b[7]){case 4:U(d,2*(b[8]<<7));break;case 126:N(d,"XG")}break;case 65:switch(b[8]){case 4:U(d,
b[9]<<7);break;case 127:N(d,"GS");break;case 21:c=b[7]-15,b=b[8],0===c?0!==b?S(d,9,!0):S(d,9,!1):10<=c?0!==b?S(d,c-1,!0):S(d,c-1,!1):0!==b?S(d,c,!0):S(d,c,!1)}}break;default:S(d,9,!0)}};v("SoundFont.WebMidiLink",Z);v("SoundFont.WebMidiLink.prototype.setup",Z.prototype.La);v("SoundFont.WebMidiLink.prototype.loadSoundFont",Z.prototype.ga);v("SoundFont.WebMidiLink.prototype.cancelLoading",Z.prototype.ta);v("SoundFont.WebMidiLink.prototype.setLoadCallback",Z.prototype.Ka);v("SoundFont.WebMidiLink.prototype.setReverb",Z.prototype.sa);}).call(this); //# sourceMappingURL=sf2synth.min.js.map
